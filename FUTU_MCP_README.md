# å¯Œé€” MCP æœåŠ¡å™¨

å°†å¯Œé€”APIå®¢æˆ·ç«¯åŠŸèƒ½æš´éœ²ä¸º MCP (Model Context Protocol) å·¥å…·ï¼Œå…è®¸ AI åŠ©æ‰‹é€šè¿‡æ ‡å‡†åŒ–æ¥å£è®¿é—®å¯Œé€”çš„è‚¡ç¥¨æ•°æ®ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”— **æ ‡å‡†åŒ–æ¥å£**: é€šè¿‡ MCP åè®®æä¾›ç»Ÿä¸€çš„APIè®¿é—®æ–¹å¼
- ğŸ“ˆ **è‡ªé€‰è‚¡ç®¡ç†**: è·å–å¯Œé€”ç”¨æˆ·çš„è‡ªé€‰è‚¡åˆ—è¡¨
- âš™ï¸ **çµæ´»é…ç½®**: æ”¯æŒåŠ¨æ€é…ç½®å¯Œé€”APIè¿æ¥å‚æ•°
- ğŸ“Š **çŠ¶æ€ç›‘æ§**: å®æ—¶æŸ¥çœ‹å®¢æˆ·ç«¯è¿æ¥çŠ¶æ€
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

## å®‰è£…ä¾èµ–

### 1. å®‰è£… MCP åº“

```bash
pip install mcp
```

### 2. å®‰è£…å¯Œé€”SDKï¼ˆå¯é€‰ï¼Œç”¨äºå®é™…è¿æ¥ï¼‰

```bash
pip install futu-api
```

### 3. å®‰è£…å…¶ä»–ä¾èµ–

```bash
pip install pydantic
```

æˆ–è€…ç›´æ¥å®‰è£…é¡¹ç›®çš„æ‰€æœ‰ä¾èµ–ï¼š

```bash
pip install -r requirements.txt
```

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨å¯Œé€”å®¢æˆ·ç«¯

ç¡®ä¿å¯Œé€”ç‰›ç‰›å®¢æˆ·ç«¯å·²å¯åŠ¨å¹¶ç™»å½•ï¼Œä¸”å·²å¼€å¯APIæ¥å£ï¼š

- æ‰“å¼€å¯Œé€”ç‰›ç‰›å®¢æˆ·ç«¯
- ç™»å½•è´¦æˆ·
- åœ¨è®¾ç½®ä¸­å¼€å¯APIæ¥å£ï¼ˆé»˜è®¤ç«¯å£11111ï¼‰

### 2. å¯åŠ¨ MCP æœåŠ¡å™¨

#### æ–¹æ³•ä¸€ï¼šä½œä¸º Python æ¨¡å—è¿è¡Œï¼ˆæ¨èï¼‰

```bash
python -m futu_mcp
```

#### æ–¹æ³•äºŒï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬

```bash
python futu_mcp/start_futu_mcp.py
```

#### æ–¹æ³•ä¸‰ï¼šç›´æ¥è¿è¡ŒæœåŠ¡å™¨

```bash
python futu_mcp/futu_mcp_server.py
```

### 3. é…ç½®å‚æ•°ï¼ˆå¯é€‰ï¼‰

```bash
# æŒ‡å®šå¯Œé€”APIä¸»æœºå’Œç«¯å£
python -m futu_mcp --host 192.168.1.100 --port 11111

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
python -m futu_mcp --config my_config.json

# è®¾ç½®æ—¥å¿—çº§åˆ«
python -m futu_mcp --log-level DEBUG
```

## å¯ç”¨å·¥å…·

### 1. get_watchlist

è·å–å¯Œé€”ç”¨æˆ·çš„è‡ªé€‰è‚¡åˆ—è¡¨

**å‚æ•°:**

- `market` (å¯é€‰): å¸‚åœºç±»å‹ï¼Œé»˜è®¤ä¸º"ç¾è‚¡"ï¼Œæ”¯æŒ["ç¾è‚¡", "æ¸¯è‚¡", "Aè‚¡"]

**ç¤ºä¾‹:**

```json
{
  "market": "ç¾è‚¡"
}
```

**è¿”å›:**

- å‹å¥½æ ¼å¼çš„è‡ªé€‰è‚¡åˆ—è¡¨
- JSONæ ¼å¼çš„è¯¦ç»†æ•°æ®

### 2. configure_futu_client

é…ç½®å¯Œé€”APIå®¢æˆ·ç«¯è¿æ¥å‚æ•°

**å‚æ•°:**

- `host` (å¿…éœ€): å¯Œé€”APIä¸»æœºåœ°å€
- `port` (å¿…éœ€): å¯Œé€”APIç«¯å£
- `unlock_pwd` (å¯é€‰): è§£é”å¯†ç 

**ç¤ºä¾‹:**

```json
{
  "host": "127.0.0.1",
  "port": 11111,
  "unlock_pwd": "your_password"
}
```

### 3. get_client_status

è·å–å¯Œé€”å®¢æˆ·ç«¯è¿æ¥çŠ¶æ€å’Œé…ç½®ä¿¡æ¯

**å‚æ•°:** æ— 

**è¿”å›:**

- å®¢æˆ·ç«¯åˆå§‹åŒ–çŠ¶æ€
- è¿æ¥é…ç½®ä¿¡æ¯
- æœ€åé”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœ‰ï¼‰

## é…ç½®æ–‡ä»¶

### futu_mcp_config.json

```json
{
  "name": "futu-mcp-server",
  "description": "å¯Œé€”API MCPæœåŠ¡å™¨",
  "version": "1.0.0",
  
  "futu_api": {
    "default_host": "127.0.0.1",
    "default_port": 11111,
    "timeout": 30,
    "retry_attempts": 3
  },
  
  "logging": {
    "level": "INFO",
    "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    "file": "logs/futu_mcp_server.log"
  }
}
```

## ä½¿ç”¨ç¤ºä¾‹

### åœ¨ AI åŠ©æ‰‹ä¸­ä½¿ç”¨

å½“ MCP æœåŠ¡å™¨è¿è¡Œåï¼ŒAI åŠ©æ‰‹å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è°ƒç”¨å·¥å…·ï¼š

1. **è·å–è‡ªé€‰è‚¡åˆ—è¡¨:**

   ```
   è¯·å¸®æˆ‘è·å–ç¾è‚¡è‡ªé€‰è‚¡åˆ—è¡¨
   ```

2. **é…ç½®è¿æ¥:**

   ```
   è¯·é…ç½®å¯Œé€”å®¢æˆ·ç«¯è¿æ¥åˆ°192.168.1.100:11111
   ```

3. **æ£€æŸ¥çŠ¶æ€:**

   ```
   è¯·æ£€æŸ¥å¯Œé€”å®¢æˆ·ç«¯çš„è¿æ¥çŠ¶æ€
   ```

### å‘½ä»¤è¡Œæµ‹è¯•

```bash
# å¯åŠ¨æœåŠ¡å™¨ï¼ˆåœ¨ä¸€ä¸ªç»ˆç«¯ï¼‰
python -m futu_mcp

# è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½
python futu_mcp/test_mcp.py
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ— æ³•è¿æ¥å¯Œé€”API**
   - ç¡®ä¿å¯Œé€”ç‰›ç‰›å®¢æˆ·ç«¯å·²å¯åŠ¨å¹¶ç™»å½•
   - æ£€æŸ¥APIæ¥å£æ˜¯å¦å·²å¼€å¯
   - éªŒè¯ä¸»æœºå’Œç«¯å£é…ç½®æ˜¯å¦æ­£ç¡®

2. **MCPåº“å¯¼å…¥é”™è¯¯**

   ```bash
   pip install mcp
   ```

3. **å¯Œé€”SDKå¯¼å…¥é”™è¯¯**

   ```bash
   pip install futu-api
   ```

4. **æƒé™é”™è¯¯**
   - ç¡®ä¿æœ‰è¶³å¤Ÿçš„æƒé™è®¿é—®å¯Œé€”API
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f logs/futu_mcp_server.log

# å¯ç”¨è°ƒè¯•æ—¥å¿—
python -m futu_mcp --log-level DEBUG
```

## æ‰©å±•åŠŸèƒ½

### æ·»åŠ æ–°å·¥å…·

åœ¨ `futu_mcp_server.py` ä¸­æ·»åŠ æ–°çš„å·¥å…·ï¼š

1. åœ¨ `list_tools()` å‡½æ•°ä¸­æ·»åŠ å·¥å…·å®šä¹‰
2. åœ¨ `call_tool()` å‡½æ•°ä¸­æ·»åŠ å·¥å…·å¤„ç†é€»è¾‘
3. å®ç°å…·ä½“çš„å¤„ç†å‡½æ•°

### ç¤ºä¾‹ï¼šæ·»åŠ è‚¡ç¥¨æŠ¥ä»·å·¥å…·

```python
# åœ¨ list_tools() ä¸­æ·»åŠ 
Tool(
    name="get_stock_quote",
    description="è·å–è‚¡ç¥¨å®æ—¶æŠ¥ä»·",
    inputSchema={
        "type": "object",
        "properties": {
            "symbol": {
                "type": "string",
                "description": "è‚¡ç¥¨ä»£ç "
            }
        },
        "required": ["symbol"]
    }
)

# åœ¨ call_tool() ä¸­æ·»åŠ å¤„ç†
elif name == "get_stock_quote":
    return await handle_get_stock_quote(arguments)

# å®ç°å¤„ç†å‡½æ•°
async def handle_get_stock_quote(arguments: Dict[str, Any]) -> List[TextContent]:
    # å®ç°è·å–è‚¡ç¥¨æŠ¥ä»·çš„é€»è¾‘
    pass
```

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: [TradeMind](https://github.com/your-repo/trademind)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/your-repo/trademind/issues)
